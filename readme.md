# 微信缓存图片解密工具

## 微信缓存图片

微信的缓存图片一般在`\WeChat Files\wxid_\FileStorage\Image\时间`目录下。

图片后缀是以`.dat`结尾，图片是加密的格式。

![image-20231019180839069](https://img2023.cnblogs.com/blog/2080041/202310/2080041-20231019180841362-347313409.png) 

## 微信缓存图片解密

微信缓存图片用的加密算法是`异或`，而且是`单字节`的密钥，所以我们就可以进行密钥的爆破。

图片一般分为`PNG`、`JPG`,文件头的数据是固定的，比如PNG文件头是`0x89 0x50`,JPG文件头是`0xFF 0xD8`。

将加密的`.dat`文件与PNG和JPG文件头密钥进行异或，如果异或出来的`密钥`是`两个相同的字节`，那么`密钥就是正确`的。

![image-20231019181747774](https://img2023.cnblogs.com/blog/2080041/202310/2080041-20231019181748431-1702935223.png) 

![image-20231019182048458](https://img2023.cnblogs.com/blog/2080041/202310/2080041-20231019182733220-1791922627.png) 

![image-20231019182529398](https://img2023.cnblogs.com/blog/2080041/202310/2080041-20231019182530115-1262970811.png) 

## 解密程序演示

 ![image-20231019182638945](https://img2023.cnblogs.com/blog/2080041/202310/2080041-20231019182639530-1345444377.png) 

![image-20231019182716125](https://img2023.cnblogs.com/blog/2080041/202310/2080041-20231019183407471-2092432937.png) 
